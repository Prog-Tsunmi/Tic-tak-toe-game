<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tic Tac Toe - VIP Edition</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #1a2a6c, #b21f1f, #fdbb2d);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            max-width: 800px;
            width: 100%;
            background-color: rgba(255, 255, 255, 0.9);
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            overflow: hidden;
        }

        header {
            background: linear-gradient(to right, #2c3e50, #4a6491);
            color: white;
            padding: 20px;
            text-align: center;
            position: relative;
        }

        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .tagline {
            font-size: 1.2rem;
            opacity: 0.9;
        }

        .admin-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            padding: 8px 15px;
            background: #fdbb2d;
            color: #2c3e50;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
        }

        .game-area {
            padding: 30px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .timer-section {
            background-color: #2c3e50;
            color: white;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            width: 100%;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .timer {
            font-size: 2.5rem;
            font-weight: bold;
            margin: 10px 0;
            color: #fdbb2d;
        }

        .vip-section {
            background-color: #f8f9fa;
            border: 2px dashed #4a6491;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            width: 100%;
            text-align: center;
        }

        .vip-section h3 {
            color: #2c3e50;
            margin-bottom: 15px;
        }

        .vip-input {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 15px;
        }

        input[type="text"], input[type="number"], input[type="password"] {
            padding: 12px;
            border: 2px solid #4a6491;
            border-radius: 8px;
            font-size: 1rem;
            width: 200px;
        }

        button {
            padding: 12px 25px;
            background: linear-gradient(to right, #2c3e50, #4a6491);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: bold;
            transition: all 0.3s ease;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        button:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 8px rgba(0, 0, 0, 0.15);
            background: linear-gradient(to right, #4a6491, #2c3e50);
        }

        button:disabled {
            background: #cccccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .game-board {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin: 20px 0;
            max-width: 400px;
            width: 100%;
        }

        .cell {
            aspect-ratio: 1;
            background-color: #e9ecef;
            border: none;
            border-radius: 10px;
            font-size: 3rem;
            font-weight: bold;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .cell:hover {
            background-color: #d8d8d8;
            transform: translateY(-3px);
        }

        .cell.x {
            color: #e74c3c;
        }

        .cell.o {
            color: #3498db;
        }

        .status {
            font-size: 1.5rem;
            margin: 20px 0;
            font-weight: bold;
            color: #2c3e50;
            text-align: center;
            min-height: 36px;
        }

        .controls {
            display: flex;
            gap: 15px;
            margin-top: 20px;
        }

        .vip-active {
            background-color: #fdbb2d;
            color: #2c3e50;
            padding: 10px 20px;
            border-radius: 30px;
            font-weight: bold;
            display: inline-block;
            margin-top: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .locked-message {
            background-color: #e74c3c;
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            margin-top: 20px;
            display: none;
        }

        .locked-message h3 {
            margin-bottom: 10px;
        }

        /* Admin Panel Styles */
        .admin-panel {
            display: none;
            background-color: #f8f9fa;
            border: 2px solid #4a6491;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
            width: 100%;
        }

        .admin-panel h3 {
            color: #2c3e50;
            margin-bottom: 15px;
            text-align: center;
        }

        .admin-form {
            display: flex;
            flex-direction: column;
            gap: 15px;
            max-width: 400px;
            margin: 0 auto;
        }

        .admin-form-row {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .admin-form-row label {
            width: 120px;
            font-weight: bold;
            color: #2c3e50;
        }

        .vip-codes-list {
            margin-top: 20px;
            max-height: 200px;
            overflow-y: auto;
            border: 1px solid #ddd;
            border-radius: 5px;
            padding: 10px;
        }

        .vip-code-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px;
            border-bottom: 1px solid #eee;
        }

        .vip-code-item:last-child {
            border-bottom: none;
        }

        .remove-vip-code {
            padding: 4px 8px;
            background: #e74c3c;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.8rem;
        }

        footer {
            background-color: #2c3e50;
            color: white;
            padding: 15px;
            text-align: center;
            font-size: 0.9rem;
        }

        @media (max-width: 600px) {
            .game-board {
                max-width: 300px;
            }
            
            .cell {
                font-size: 2.5rem;
            }
            
            h1 {
                font-size: 2rem;
            }
            
            .vip-input {
                flex-direction: column;
                align-items: center;
            }
            
            input[type="text"], input[type="password"] {
                width: 100%;
                max-width: 250px;
            }
            
            .admin-form-row {
                flex-direction: column;
                align-items: flex-start;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Tic Tac Toe</h1>
            <p class="tagline">VIP Edition - Play without limits!</p>
            <button class="admin-btn" id="admin-btn">Admin</button>
        </header>
        
        <div class="game-area">
            <div class="timer-section">
                <h2>Game Timer</h2>
                <div class="timer" id="timer">05:00</div>
                <p>Time remaining in your session</p>
            </div>
            
            <div class="vip-section">
                <h3>VIP Access</h3>
                <p>Enter your VIP code to unlock unlimited play</p>
                <div class="vip-input">
                    <input type="text" id="vip-code" placeholder="Enter VIP code">
                    <button id="activate-vip">Activate VIP</button>
                </div>
                <div id="vip-status"></div>
            </div>
            
            <div class="status" id="status">Player X's turn</div>
            
            <div class="game-board" id="game-board">
                <!-- Cells will be generated by JavaScript -->
            </div>
            
            <div class="controls">
                <button id="new-game">New Game</button>
                <button id="reset-game">Reset Game</button>
            </div>
            
            <div class="locked-message" id="locked-message">
                <h3>Game Locked!</h3>
                <p>Your free session has ended. Please enter a VIP code to continue playing.</p>
                <p>For VIP purchases and any questions, email us at: <strong>dengluffy@gmail.com</strong></p>
            </div>
            
            <!-- Admin Panel -->
            <div class="admin-panel" id="admin-panel">
                <h3>Admin Panel - VIP Code Management</h3>
                <div class="admin-form">
                    <div class="admin-form-row">
                        <label for="admin-password">Manager Password:</label>
                        <input type="password" id="admin-password" placeholder="Enter manager password">
                    </div>
                    <div class="admin-form-row">
                        <label for="new-vip-code">VIP Code:</label>
                        <input type="text" id="new-vip-code" placeholder="Enter new VIP code">
                    </div>
                    <div class="admin-form-row">
                        <label for="vip-duration">Duration (minutes):</label>
                        <input type="number" id="vip-duration" placeholder="Duration in minutes" value="60" min="1">
                    </div>
                    <button id="add-vip-code">Add VIP Code</button>
                </div>
                
                <h4>Active VIP Codes</h4>
                <div class="vip-codes-list" id="vip-codes-list">
                    <!-- VIP codes will be listed here -->
                </div>
            </div>
        </div>
        
        <footer>
            <p>Tic Tac Toe VIP Edition &copy; 2023 | For support: dengluffy@gmail.com</p>
        </footer>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Game state
            let currentPlayer = 'X';
            let gameBoard = ['', '', '', '', '', '', '', '', ''];
            let gameActive = true;
            let isVIP = false;
            let timeLeft = 300; // 5 minutes in seconds
            let timerInterval;
            let vipCodes = JSON.parse(localStorage.getItem('vipCodes')) || {}; // Load from localStorage
            
            // DOM elements
            const statusElement = document.getElementById('status');
            const timerElement = document.getElementById('timer');
            const gameBoardElement = document.getElementById('game-board');
            const newGameButton = document.getElementById('new-game');
            const resetGameButton = document.getElementById('reset-game');
            const vipCodeInput = document.getElementById('vip-code');
            const activateVIPButton = document.getElementById('activate-vip');
            const vipStatusElement = document.getElementById('vip-status');
            const lockedMessageElement = document.getElementById('locked-message');
            const adminButton = document.getElementById('admin-btn');
            const adminPanel = document.getElementById('admin-panel');
            const adminPasswordInput = document.getElementById('admin-password');
            const newVIPCodeInput = document.getElementById('new-vip-code');
            const vipDurationInput = document.getElementById('vip-duration');
            const addVIPCodeButton = document.getElementById('add-vip-code');
            const vipCodesListElement = document.getElementById('vip-codes-list');
            
            // Manager password
            const managerPassword = "113000";
            
            // Winning combinations
            const winningConditions = [
                [0, 1, 2], [3, 4, 5], [6, 7, 8], // Rows
                [0, 3, 6], [1, 4, 7], [2, 5, 8], // Columns
                [0, 4, 8], [2, 4, 6]             // Diagonals
            ];
            
            // Initialize the game board
            function initializeBoard() {
                gameBoardElement.innerHTML = '';
                for (let i = 0; i < 9; i++) {
                    const cell = document.createElement('div');
                    cell.classList.add('cell');
                    cell.setAttribute('data-index', i);
                    cell.addEventListener('click', () => handleCellClick(i));
                    gameBoardElement.appendChild(cell);
                }
            }
            
            // Handle cell click
            function handleCellClick(index) {
                if (!gameActive || gameBoard[index] !== '') return;
                if (!isVIP && timeLeft <= 0) return;
                
                gameBoard[index] = currentPlayer;
                const cell = document.querySelector(`.cell[data-index="${index}"]`);
                cell.textContent = currentPlayer;
                cell.classList.add(currentPlayer.toLowerCase());
                
                if (checkWinner()) {
                    statusElement.textContent = `Player ${currentPlayer} wins!`;
                    gameActive = false;
                    highlightWinningCells();
                    return;
                }
                
                if (isBoardFull()) {
                    statusElement.textContent = "It's a tie!";
                    gameActive = false;
                    return;
                }
                
                currentPlayer = currentPlayer === 'X' ? 'O' : 'X';
                statusElement.textContent = `Player ${currentPlayer}'s turn`;
            }
            
            // Check for a winner
            function checkWinner() {
                for (let condition of winningConditions) {
                    const [a, b, c] = condition;
                    if (gameBoard[a] && gameBoard[a] === gameBoard[b] && gameBoard[a] === gameBoard[c]) {
                        return true;
                    }
                }
                return false;
            }
            
            // Highlight winning cells
            function highlightWinningCells() {
                for (let condition of winningConditions) {
                    const [a, b, c] = condition;
                    if (gameBoard[a] && gameBoard[a] === gameBoard[b] && gameBoard[a] === gameBoard[c]) {
                        condition.forEach(index => {
                            document.querySelector(`.cell[data-index="${index}"]`).style.backgroundColor = '#a8e6cf';
                        });
                        break;
                    }
                }
            }
            
            // Check if the board is full
            function isBoardFull() {
                return gameBoard.every(cell => cell !== '');
            }
            
            // Start a new game
            function newGame() {
                if (!isVIP && timeLeft <= 0) {
                    showLockedMessage();
                    return;
                }
                
                gameBoard = ['', '', '', '', '', '', '', '', ''];
                gameActive = true;
                currentPlayer = 'X';
                statusElement.textContent = `Player ${currentPlayer}'s turn`;
                
                const cells = document.querySelectorAll('.cell');
                cells.forEach(cell => {
                    cell.textContent = '';
                    cell.classList.remove('x', 'o');
                    cell.style.backgroundColor = '#e9ecef';
                });
            }
            
            // Reset the entire game
            function resetGame() {
                if (!isVIP && timeLeft <= 0) {
                    showLockedMessage();
                    return;
                }
                
                newGame();
                if (!isVIP) {
                    timeLeft = 300;
                    updateTimerDisplay();
                    startTimer();
                }
            }
            
            // Update timer display
            function updateTimerDisplay() {
                const minutes = Math.floor(timeLeft / 60);
                const seconds = timeLeft % 60;
                timerElement.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                
                // Change color when time is running out
                if (timeLeft <= 60) {
                    timerElement.style.color = '#e74c3c';
                } else {
                    timerElement.style.color = '#fdbb2d';
                }
            }
            
            // Start the timer
            function startTimer() {
                clearInterval(timerInterval);
                timerInterval = setInterval(() => {
                    if (timeLeft > 0) {
                        timeLeft--;
                        updateTimerDisplay();
                        
                        if (timeLeft <= 0 && !isVIP) {
                            clearInterval(timerInterval);
                            gameActive = false;
                            showLockedMessage();
                        } else if (timeLeft <= 0 && isVIP) {
                            // VIP time expired
                            isVIP = false;
                            vipStatusElement.innerHTML = '';
                            statusElement.textContent = 'VIP time expired. Player X\'s turn';
                            timeLeft = 300; // Reset to free play time
                            updateTimerDisplay();
                            startTimer();
                        }
                    }
                }, 1000);
            }
            
            // Show locked message
            function showLockedMessage() {
                lockedMessageElement.style.display = 'block';
                statusElement.textContent = 'Game locked. Enter VIP code to continue.';
                gameActive = false;
                
                // Disable game board
                const cells = document.querySelectorAll('.cell');
                cells.forEach(cell => {
                    cell.style.pointerEvents = 'none';
                    cell.style.opacity = '0.6';
                });
            }
            
            // Hide locked message
            function hideLockedMessage() {
                lockedMessageElement.style.display = 'none';
                gameActive = true;
                
                // Enable game board
                const cells = document.querySelectorAll('.cell');
                cells.forEach(cell => {
                    cell.style.pointerEvents = 'auto';
                    cell.style.opacity = '1';
                });
            }
            
            // Activate VIP
            function activateVIP() {
                const enteredCode = vipCodeInput.value.trim();
                
                if (!enteredCode) {
                    alert('Please enter a VIP code.');
                    return;
                }
                
                if (vipCodes[enteredCode]) {
                    isVIP = true;
                    const duration = vipCodes[enteredCode];
                    timeLeft = duration * 60; // Convert minutes to seconds
                    updateTimerDisplay();
                    
                    vipStatusElement.innerHTML = `<div class="vip-active">VIP Status: ACTIVE (${duration} minutes)</div>`;
                    vipCodeInput.value = '';
                    hideLockedMessage();
                    
                    // Update status
                    if (gameActive) {
                        statusElement.textContent = `VIP Activated! Player ${currentPlayer}'s turn`;
                    } else {
                        statusElement.textContent = 'VIP Activated! Start a new game.';
                    }
                    
                    // Stop the previous timer and start a new one with VIP time
                    clearInterval(timerInterval);
                    startTimer();
                    
                    // Remove the used VIP code
                    delete vipCodes[enteredCode];
                    saveVIPCodes();
                    updateVIPCodesList();
                    
                    alert(`VIP activated! You have ${duration} minutes of play time.`);
                } else {
                    alert('Invalid VIP code. Please try again.');
                }
            }
            
            // Toggle admin panel
            function toggleAdminPanel() {
                if (adminPanel.style.display === 'block') {
                    adminPanel.style.display = 'none';
                    adminPasswordInput.value = '';
                    newVIPCodeInput.value = '';
                    vipDurationInput.value = '60';
                } else {
                    adminPanel.style.display = 'block';
                }
            }
            
            // Add VIP code
            function addVIPCode() {
                const password = adminPasswordInput.value;
                const newCode = newVIPCodeInput.value.trim();
                const duration = parseInt(vipDurationInput.value);
                
                if (password !== managerPassword) {
                    alert('Incorrect manager password.');
                    return;
                }
                
                if (!newCode) {
                    alert('Please enter a VIP code.');
                    return;
                }
                
                if (isNaN(duration) || duration <= 0) {
                    alert('Please enter a valid duration in minutes.');
                    return;
                }
                
                vipCodes[newCode] = duration;
                saveVIPCodes();
                updateVIPCodesList();
                
                newVIPCodeInput.value = '';
                vipDurationInput.value = '60';
                adminPasswordInput.value = '';
                
                alert(`VIP code "${newCode}" added with ${duration} minutes duration.`);
            }
            
            // Remove VIP code
            function removeVIPCode(code) {
                if (confirm(`Are you sure you want to remove VIP code "${code}"?`)) {
                    delete vipCodes[code];
                    saveVIPCodes();
                    updateVIPCodesList();
                }
            }
            
            // Save VIP codes to localStorage
            function saveVIPCodes() {
                localStorage.setItem('vipCodes', JSON.stringify(vipCodes));
            }
            
            // Update VIP codes list display
            function updateVIPCodesList() {
                vipCodesListElement.innerHTML = '';
                
                for (const [code, duration] of Object.entries(vipCodes)) {
                    const codeItem = document.createElement('div');
                    codeItem.className = 'vip-code-item';
                    codeItem.innerHTML = `
                        <span><strong>${code}</strong></span>
                        <span>${duration} minutes</span>
                        <button class="remove-vip-code" data-code="${code}">Remove</button>
                    `;
                    vipCodesListElement.appendChild(codeItem);
                }
                
                // Add event listeners to remove buttons
                document.querySelectorAll('.remove-vip-code').forEach(button => {
                    button.addEventListener('click', (e) => {
                        const codeToRemove = e.target.getAttribute('data-code');
                        removeVIPCode(codeToRemove);
                    });
                });
                
                if (Object.keys(vipCodes).length === 0) {
                    vipCodesListElement.innerHTML = '<div style="text-align: center; color: #666;">No VIP codes added</div>';
                }
            }
            
            // Event listeners
            newGameButton.addEventListener('click', newGame);
            resetGameButton.addEventListener('click', resetGame);
            activateVIPButton.addEventListener('click', activateVIP);
            adminButton.addEventListener('click', toggleAdminPanel);
            addVIPCodeButton.addEventListener('click', addVIPCode);
            
            // Allow pressing Enter to activate VIP
            vipCodeInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    activateVIP();
                }
            });
            
            // Allow pressing Enter in admin panel
            adminPasswordInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    addVIPCode();
                }
            });
            
            newVIPCodeInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    addVIPCode();
                }
            });
            
            // Initialize the game
            initializeBoard();
            updateTimerDisplay();
            startTimer();
            updateVIPCodesList();
        });
    </script>
</body>
</html>